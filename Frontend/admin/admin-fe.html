<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Frontend Server Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f9fc;
      padding: 20px;
    }

    h2 {
      text-align: center;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    th, td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    th {
      background-color: #2c3e50;
      color: white;
    }

    .status-active {
      color: green;
      font-weight: bold;
    }

    .status-down {
      color: red;
      font-weight: bold;
    }

    button {
      padding: 6px 12px;
      margin-right: 8px;
      border: none;
      background-color: #3498db;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }

    button.shutdown {
      background-color: #e74c3c;
    }

    button.reactivate {
      background-color: #2ecc71;
    }

          .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #2c3e50;
      padding: 0.75em 1.5em;
      color: white;
      font-family: Arial, sans-serif;
    }

    .nav-left, .nav-right {
      display: flex;
      align-items: center;
    }

    .nav-left a {
      margin-right: 1.2em;
      text-decoration: none;
      color: white;
      font-weight: bold;
    }

    .nav-left a:hover {
      text-decoration: underline;
    }

    .user-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background-color: #ecf0f1;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      color: #2c3e50;
      cursor: pointer;
    }

    .user-icon:hover {
      background-color: #bdc3c7;
    }

  </style>
</head>
<body>
    <div class="navbar">
      <div class="nav-left">
        <a href="/admin">Backend</a>
        <a href="/admin/fe">Frontend</a>
      </div>
    </div>

<h2>Frontend Server Nodes</h2>

<table id="feTable">
  <thead>
    <tr>
      <th>Address</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <!-- Placeholder row. Replace with dynamic data -->
    <tr data-addr="127.0.0.1:8000">
      <td>127.0.0.1:8000</td>
      <td><span class="status-active">Active</span></td>
      <td>
        <button class="shutdown" onclick="sendCommand('DOWN', '127.0.0.1:8000')">Shutdown</button>
        <button class="reactivate" onclick="sendCommand('UP', '127.0.0.1:8000')">Reactivate</button>
      </td>
    </tr>
    <tr data-addr="127.0.0.1:8001">
      <td>127.0.0.1:8001</td>
      <td><span class="status-active">Active</span></td>
      <td>
        <button class="shutdown" onclick="sendCommand('DOWN', '127.0.0.1:8001')">Shutdown</button>
        <button class="reactivate" onclick="sendCommand('UP', '127.0.0.1:8001')">Reactivate</button>
      </td>
    </tr>
    <tr data-addr="127.0.0.1:8002">
      <td>127.0.0.1:8002</td>
      <td><span class="status-active">Active</span></td>
      <td>
        <button class="shutdown" onclick="sendCommand('DOWN', '127.0.0.1:8002')">Shutdown</button>
        <button class="reactivate" onclick="sendCommand('UP', '127.0.0.1:8002')">Reactivate</button>
      </td>
    </tr>
    <tr data-addr="127.0.0.1:8003">
      <td>127.0.0.1:8003</td>
      <td><span class="status-active">Active</span></td>
      <td>
        <button class="shutdown" onclick="sendCommand('DOWN', '127.0.0.1:8003')">Shutdown</button>
        <button class="reactivate" onclick="sendCommand('UP', '127.0.0.1:8003')">Reactivate</button>
      </td>
    </tr>
    <tr data-addr="127.0.0.1:8004">
      <td>127.0.0.1:8004</td>
      <td><span class="status-active">Active</span></td>
      <td>
        <button class="shutdown" onclick="sendCommand('DOWN', '127.0.0.1:8004')">Shutdown</button>
        <button class="reactivate" onclick="sendCommand('UP', '127.0.0.1:8004')">Reactivate</button>
      </td>
    </tr>
    <!-- Add more rows dynamically -->
  </tbody>
</table>

<script>
function sendCommand(action, addr) {
  fetch('http://127.0.0.1:8080/admin/fe-command', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ action, addr })
  })
  .then(response => {
    if (response.ok) {
      const row = document.querySelector(`tr[data-addr="${addr}"]`);
      const statusCell = row.querySelector('td:nth-child(2)'); // status is second column

      if (action === 'DOWN') {
        statusCell.innerHTML = '<span class="status-down">Down</span>';
      } else if (action === 'UP') {
        statusCell.innerHTML = '<span class="status-active">Active</span>';
      }

      alert(`Command '${action}' sent to ${addr}`);
    } else {
      alert(`Failed to send command to ${addr}`);
    }
  })
  .catch(error => {
    console.error(error);
    alert("Error sending command.");
  });
}
</script>

</body>
</html>
